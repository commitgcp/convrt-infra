# Terraform Modules Template

Put a short description of what this module does.

<!-- terraform-docs output will go here -->
<!-- BEGINNING OF PRE-COMMIT-TERRAFORM DOCS HOOK -->
## Requirements

| Name | Version |
|------|---------|
| <a name="requirement_terraform"></a> [terraform](#requirement\_terraform) | >= 0.13 |

## Providers

| Name | Version |
|------|---------|
| <a name="provider_google"></a> [google](#provider\_google) | n/a |

## Modules

| Name | Source | Version |
|------|--------|---------|
| <a name="module_dns"></a> [dns](#module\_dns) | terraform-google-modules/cloud-dns/google | 5.0.1 |
| <a name="module_hub_spoke"></a> [hub\_spoke](#module\_hub\_spoke) | terraform-google-modules/network/google//modules/network-peering | ~> 7.3 |
| <a name="module_nat"></a> [nat](#module\_nat) | terraform-google-modules/cloud-nat/google | ~> 4.0 |
| <a name="module_vpc"></a> [vpc](#module\_vpc) | terraform-google-modules/network/google | ~> 7.3 |

## Resources

| Name | Type |
|------|------|
| [google_compute_address.nat_static_address](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_address) | resource |
| [google_compute_global_address.private_service_access_address](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_global_address) | resource |
| [google_project_service.api](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/project_service) | resource |
| [google_service_networking_connection.private_vpc_connection](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/service_networking_connection) | resource |

## Inputs

| Name | Description | Type | Default | Required |
|------|-------------|------|---------|:--------:|
| <a name="input_default_routes"></a> [default\_routes](#input\_default\_routes) | The list of default routes to create to ALL VPCs<br><br>Route Configuration<br>[<br>    {<br>        name                   = string<br>        description            = string (default null)<br>        tags                   = string (default "")<br>        destination\_range      = string (default null)<br>        next\_hop\_internet      = bool (default false)<br>        next\_hop\_ip            = string (default null)<br>        next\_hop\_instance      = string (default null)<br>        next\_hop\_instance\_zone = string (default null)<br>        next\_hop\_vpn\_tunnel    = string (default null)<br>        next\_hop\_ilb           = string (default null)<br>        priority               = string (default null)<br>    }<br>] | <pre>list(object({<br>    name                   = string<br>    description            = optional(string)<br>    tags                   = optional(string, "")<br>    destination_range      = optional(string)<br>    next_hop_internet      = optional(bool, false)<br>    next_hop_ip            = optional(string)<br>    next_hop_instance      = optional(string)<br>    next_hop_instance_zone = optional(string)<br>    next_hop_vpn_tunnel    = optional(string)<br>    next_hop_ilb           = optional(string)<br>    priority               = optional(string)<br>  }))</pre> | <pre>[<br>  {<br>    "description": "route through IGW to access internet",<br>    "destination_range": "0.0.0.0/0",<br>    "name": "rt-egress-internet",<br>    "next_hop_internet": "true"<br>  },<br>  {<br>    "description": "route through IGW to GCP windows KMS",<br>    "destination_range": "35.190.247.13/32",<br>    "name": "rt-windows-kms",<br>    "next_hop_internet": "true"<br>  }<br>]</pre> | no |
| <a name="input_dns"></a> [dns](#input\_dns) | The list of DNSs being created.<br><br>DNS configuration<br><br>dns-x =<br>    {<br>        type              = string (Options: 'public', 'private', 'forwarding', 'peering')<br>        domain            = string<br><br>        target\_name\_server\_addresses = string (When type 'forwarding', configuration: https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/dns_managed_zone#target_name_servers)<br>        target\_network = string (When type 'peering, The id or fully qualified URL of the VPC network to forward queries to)<br>        private\_visibility\_config\_networks = list(string) (List of VPC that can see this zone.)<br><br>        dnssec\_config = any (Optional, further information https://github.com/terraform-google-modules/terraform-google-cloud-dns)<br>        default\_key\_specs\_key = any (Optional, further information https://github.com/terraform-google-modules/terraform-google-cloud-dns)<br>        default\_key\_specs\_zone = any (Optional, further information https://github.com/terraform-google-modules/terraform-google-cloud-dns)<br>    }<br><br>dns-z = {...} | <pre>map(object({<br>    type   = optional(string, "private")<br>    domain = string<br><br>    target_name_server_addresses = optional(list(map(string)), [])<br><br>    target_network                     = optional(string, "")<br>    private_visibility_config_networks = optional(list(string), [])<br><br>    #"Object containing : kind, non_existence, state. Please see https://www.terraform.io/docs/providers/google/r/dns_managed_zone#dnssec_config for futhers details"<br>    # Follow DNS module repository, because implementation should be changed to use object instead of map of any<br>    dnssec_config = optional(any, {})<br><br>    default_key_specs_key = optional(object({<br>      algorithm  = optional(string, "rsasha256")<br>      key_length = optional(number, 2048)<br>      key_type   = optional(string, "keySigning")<br>      kind       = optional(string, "dns#dnsKeySpec")<br>    }))<br><br>    default_key_specs_zone = optional(object({<br>      algorithm  = optional(string, "rsasha256")<br>      key_length = optional(number, 1024)<br>      key_type   = optional(string, "zoneSigning")<br>      kind       = optional(string, "dns#dnsKeySpec")<br>    }))<br>  }))</pre> | `{}` | no |
| <a name="input_firewall_rules"></a> [firewall\_rules](#input\_firewall\_rules) | The list of firewall rules being created per VPC<br><br>Firewall rule configuration<br><br>vpc-x = [<br>    {<br>        name                    = string<br>        description             = string (default null)<br>        direction               = string (INGRESS OR EGRESS)<br>        priority                = number (default null)<br>        ranges                  = list(string) (default null)<br>        source\_tags             = list(string) (default null)<br>        source\_service\_accounts = list(string) (default null)<br>        target\_tags             = list(string) (default null)<br>        target\_service\_accounts = list(string) (default null)<br>        allow = list(object({<br>          protocol = string<br>          ports    = list(string)<br>        })) (default [])<br>        deny = list(object({<br>          protocol = string<br>          ports    = list(string)<br>        })) (default [])<br>        log\_config = object({<br>          metadata = string<br>        }) (default null)<br>    },<br>    {<br>        name = firewall2...<br>    }<br>],<br><br>vpc-z = [...] | <pre>map(list(object({<br>    name                    = string<br>    description             = optional(string)<br>    direction               = string<br>    priority                = optional(number)<br>    ranges                  = optional(list(string))<br>    source_tags             = optional(list(string))<br>    source_service_accounts = optional(list(string))<br>    target_tags             = optional(list(string))<br>    target_service_accounts = optional(list(string))<br>    allow = optional(list(object({<br>      protocol = string<br>      ports    = list(string)<br>    })), [])<br>    deny = optional(list(object({<br>      protocol = string<br>      ports    = list(string)<br>    })), [])<br>    log_config = optional(object({<br>      metadata = string<br>    }))<br>  })))</pre> | `{}` | no |
| <a name="input_hub_network"></a> [hub\_network](#input\_hub\_network) | Name of the Hub Network (optional) | `string` | `null` | no |
| <a name="input_nat"></a> [nat](#input\_nat) | The list of NATs being created per VPC<br><br>NAT configuration<br><br>nat-x =<br>    {<br>        region            = string<br>        min\_ports\_per\_vm  = number (default 64)<br>        network           = string<br>        router            = string (router name)<br>        router\_asn        = number (default 64514)<br>        log\_config\_enable = bool (default false)<br><br>        log\_config\_filter = string (default ALL, options: ERRORS\_ONLY, TRANSLATIONS\_ONLY, ALL)<br><br>        number\_static\_addresses            = number (default 0)<br>        source\_subnetwork\_ip\_ranges\_to\_nat = string (default ALL\_SUBNETWORKS\_ALL\_IP\_RANGES, options: ALL\_SUBNETWORKS\_ALL\_IP\_RANGES, ALL\_SUBNETWORKS\_ALL\_PRIMARY\_IP\_RANGES, LIST\_OF\_SUBNETWORKS)<br>        subnetworks = list(object({<br>          name                     = string,<br>          source\_ip\_ranges\_to\_nat  = list(string)<br>          secondary\_ip\_range\_names = list(string)<br>        })) (default [])<br>    }<br><br>nat-z = {...} | <pre>map(object({<br>    region                             = optional(string)<br>    min_ports_per_vm                   = optional(number, 64)<br>    network                            = string<br>    router                             = string<br>    router_asn                         = optional(number, 64514)<br>    log_config_enable                  = optional(bool, false)<br>    log_config_filter                  = optional(string, "ALL")<br>    number_static_addresses            = optional(number, 0)<br>    source_subnetwork_ip_ranges_to_nat = optional(string, "ALL_SUBNETWORKS_ALL_IP_RANGES")<br>    subnetworks = optional(list(object({<br>      name                     = string,<br>      source_ip_ranges_to_nat  = list(string)<br>      secondary_ip_range_names = list(string)<br>    })), [])<br><br>  }))</pre> | `{}` | no |
| <a name="input_parent"></a> [parent](#input\_parent) | Network project parent (folder) | `string` | `"fldr-common"` | no |
| <a name="input_private_service_access"></a> [private\_service\_access](#input\_private\_service\_access) | Key is VPC network and value is CIDR used for private service access (for example SQL) | `map(string)` | `{}` | no |
| <a name="input_project_id"></a> [project\_id](#input\_project\_id) | Network project ID | `string` | n/a | yes |
| <a name="input_recordsets"></a> [recordsets](#input\_recordsets) | List of DNS record objects to manage, in the standard terraform dns structure. | <pre>map(list(object({<br>    name    = optional(string, "")<br>    type    = string<br>    ttl     = optional(number)<br>    records = optional(list(string), [])<br>  })))</pre> | `{}` | no |
| <a name="input_region"></a> [region](#input\_region) | Default region | `string` | n/a | yes |
| <a name="input_routes"></a> [routes](#input\_routes) | List of routes being created per VPC. Map Key is VPC name, value is route list (see default\_routes configuration/example) | <pre>map(list(object({<br>    name                   = string<br>    description            = optional(string)<br>    tags                   = optional(string, "")<br>    destination_range      = optional(string)<br>    next_hop_internet      = optional(bool, false)<br>    next_hop_ip            = optional(string)<br>    next_hop_instance      = optional(string)<br>    next_hop_instance_zone = optional(string)<br>    next_hop_vpn_tunnel    = optional(string)<br>    next_hop_ilb           = optional(string)<br>    priority               = optional(string)<br>  })))</pre> | `{}` | no |
| <a name="input_secondary_ranges"></a> [secondary\_ranges](#input\_secondary\_ranges) | Optional secondary ranges for some subnets<br><br>Secondary subnet configuration<br>{<br>    subnet-x = [<br>        {<br>            range\_name            = string<br>            ip\_cidr\_range         = string<br>        },<br>        {<br>            range\_name            = string<br>            ip\_cidr\_range         = string<br>        },<br>        ...<br>    ],<br>    subnet-y = [...]<br>}<br><br>vpc-z = [...] | <pre>map(list(object({<br>    range_name    = string<br>    ip_cidr_range = string<br>  })))</pre> | `{}` | no |
| <a name="input_spoke_networks"></a> [spoke\_networks](#input\_spoke\_networks) | List of spoke network peer to the hub Network (optional) | `list(string)` | `[]` | no |
| <a name="input_subnets"></a> [subnets](#input\_subnets) | The list of subnets being created per VPC<br><br>Subnet Configuration<br>vpc-x = [<br>    {<br>        subnet\_name            = string<br>        subnet\_ip              = string<br>        subnet\_region          = string (default "")<br>        description            = string (default "")<br>        subnet\_private\_access  = bool (default false)<br><br>        subnet\_flow\_logs          = bool (default false)<br>        subnet\_flow\_logs\_interval = string (default "INTERVAL\_5\_SEC")<br>        subnet\_flow\_logs\_sampling = number (default 0.5)<br>        subnet\_flow\_logs\_metadata = string (default "INCLUDE\_ALL\_METADATA")<br>        subnet\_flow\_logs\_filter   = boold (default true)<br><br>        purpose                = string (default null, options: "INTERNAL\_HTTPS\_LOAD\_BALANCER")<br>        role                   = string (default null, options: ACTIVE or BACKUP. Only used when purpose is INTERNAL\_HTTPS\_LOAD\_BALANCER)<br>    },<br>    {<br>        subnet\_name = ...<br>    }<br>],<br><br>vpc-z = [...] | <pre>map(list(object({<br>    subnet_name               = string<br>    subnet_ip                 = string<br>    subnet_region             = optional(string)<br>    description               = optional(string, "")<br>    subnet_private_access     = optional(bool, false)<br>    subnet_flow_logs          = optional(bool, false)<br>    subnet_flow_logs_interval = optional(string, "INTERVAL_5_SEC")<br>    subnet_flow_logs_sampling = optional(number, 0.5)<br>    subnet_flow_logs_metadata = optional(string, "INCLUDE_ALL_METADATA")<br>    subnet_flow_logs_filter   = optional(bool, true)<br>    purpose                   = optional(string),<br>    role                      = optional(string),<br>  })))</pre> | `{}` | no |
| <a name="input_vpc"></a> [vpc](#input\_vpc) | VPC Configuration<br>vpc1 = {<br>    delete\_default\_internet\_gateway\_routes = string (default true),<br>    description = string (default ""),<br>    auto\_create\_subnetworks = string (default true),<br>    routing\_mode = string (default "GLOBAL"),<br>    mtu = number (default 1460),<br>    project\_id = string (default var.project\_id)<br>},<br>vpc2 = {...}<br>vpc3 = {...} | <pre>map(object({<br>    delete_default_internet_gateway_routes = optional(bool, false)<br>    description                            = optional(string)<br>    routing_mode                           = optional(string, "GLOBAL")<br>    project_id                             = optional(string)<br>    auto_create_subnetworks                = optional(bool, false)<br>    mtu                                    = optional(number, 1460)<br>    external_services_vpc_peering = optional(list(object({<br>      vpc                  = string<br>      project              = string<br>      import_custom_routes = optional(bool, true)<br>      export_custom_routes = optional(bool, true)<br>      })<br>    ), [])<br>  }))</pre> | n/a | yes |

## Outputs

No outputs.
<!-- END OF PRE-COMMIT-TERRAFORM DOCS HOOK -->

